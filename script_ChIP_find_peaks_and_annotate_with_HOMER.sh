#!/bin/bash

#################################################################################################

module load bowtie/2.3.4.2
module load homer/4.10

module load samtools/1.9
module load bedtools/2.26.0

module load fastx_toolkit/0.0.14
module load fastqc/0.11.7
module load trim_galore/0.4.5

#################################################################################################

FILE=$1

GENOME="hg38"

#################################################################################################
#################################################################################################
############################################ calling the PEAKS in TF/NARROW_PEAK mode :

findPeaks "${FILE}" -center -style factor -o "${FILE}.peaks.TF.txt"

#################################################################################################
#################################################################################################
############################################ annotating the PEAKS in TRANSCRIPTION_FACTOR mode :

annotatePeaks.pl "${FILE}.peaks.TF.txt" $GENOME > "${FILE}.peaks.TF.annotations.${GENOME}.txt"

#################################################################################################
#################################################################################################
############################################ calling the PEAKS in HISTONE/LARGE_PEAK mode :

findPeaks "${FILE}" -size 1000 -minDist 1000 -style histone > "${FILE}.peaks.HIST.txt"

#################################################################################################
#################################################################################################
############################################ annotating the PEAKS in HISTONE/LARGE_PEAK mode :

annotatePeaks.pl "${FILE}.peaks.HIST.txt" $GENOME > "${FILE}.peaks.HIST.annotations.${GENOME}.txt"

#################################################################################################
#################################################################################################
