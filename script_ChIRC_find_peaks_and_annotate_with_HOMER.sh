#!/bin/bash

#################################################################################################

module load bowtie/2.3.4.2
module load homer/4.10

module load samtools/1.9
module load bedtools/2.26.0

module load fastx_toolkit/0.0.14
module load fastqc/0.11.7
module load trim_galore/0.4.5

#################################################################################################

FILE=$1

INPUT=$2

GENOME="hg38"

#################################################################################################
#################################################################################################
############################################ calling the PEAKS in TF/NARROW_PEAK mode :

findPeaks "${FILE}" -center -style factor \
-i $INPUT \
-o "${FILE}.peaks.TF.over.${INPUT}.txt"

#################################################################################################
#################################################################################################
############################################ annotating the PEAKS in TRANSCRIPTION_FACTOR mode :

annotatePeaks.pl "${FILE}.peaks.TF.over.${INPUT}.txt" $GENOME > "${FILE}.peaks.TF.over.${INPUT}.annotations.${GENOME}.txt"

#################################################################################################
#################################################################################################
############################################ calling the PEAKS in HISTONE/LARGE_PEAK mode :

findPeaks "${FILE}" -size 1000 -minDist 1000 -style histone \
-i $INPUT \
-o "${FILE}.peaks.HIST.over.${INPUT}.txt"

#################################################################################################
#################################################################################################
############################################ annotating the PEAKS in HISTONE/LARGE_PEAK mode :

annotatePeaks.pl "${FILE}.peaks.HIST.over.${INPUT}.txt" $GENOME > "${FILE}.peaks.HIST.over.${INPUT}.annotations.${GENOME}.txt"

#################################################################################################
#################################################################################################
